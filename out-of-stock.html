<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Out of Stock</title>
    <link rel="stylesheet" href="styles.css">
    <!--  <script defer src="app.js"></script> -->
</head>
<body>
    <header>
      <!-- <img class="logo" src="logo.png" alt="Your Logo"> -->
        <h1>Fresh Strawberries - Out of Stock</h1>
    </header>
    <main>
        <section class="out-of-stock">
            <h2>We're sorry, fresh strawberries are currently out of stock.</h2>
            <p>Enter your email address below to be notified when they are available again:</p>
	    <form id="registerForm" onsubmit="handleSubmit(event)">
	    <!-- https://github.com/levinunnink/html-form-to-google-sheet -->
	    <!-- <form id="registerForm" method="POST" action="https://script.google.com/macros/s/AKfycbw7FL5NptauYpzzuj7l33mhKdQcXQ4n_ZtIVUdbmssB9ppwjaWFTfdt0izRYo0ZNNguoQ/exec"> -->
                <table>
                    <tr>
                        <td><label for="name">Name (optional):</label></td>
                        <td><input type="text" id="name" name="Name"></td>
                    </tr>
                    <tr>
                        <td><label for="email">Email:</label></td>
                        <td><input type="email" id="email" name="Email" required></td>
                    </tr>
                    <tr>
                        <td><label for="address">Address (optional):</label></td>
                        <td><input type="text" id="address" name="Address"></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><button class="cta-button" type="submit">Notify me</button></td>
                    </tr>
                </table>
            </form>
        </section>
    </main>
    <script>
        async function handleSubmit(event) {
            event.preventDefault();
            const form = document.getElementById("registerForm");

            const quantity = sessionStorage.getItem('quantity');
            const deliveryOption = sessionStorage.getItem('deliveryOption');
            const price = sessionStorage.getItem('price');
            data = new FormData(form);
            data.append("Quantity", quantity);
            data.append("Delivery", deliveryOption);
            data.append("Price", price);
            data.append("Event", "register");
            fetch("https://script.google.com/macros/s/AKfycbzSJp-eXJKB15OiK9cZWvDT1knrZEZpTKGan23c6kLKyvPs1w4HfES8unKyJ5Igf7KC/exec", {
                method: "POST",
                body: data
            });
            
            window.location.href = 'confirmation.html';
        }
    </script>
</body>
</html>
